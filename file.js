const _0x5e3942=_0x5b3c;(function(_0x24ee87,_0x539b13){const _0x53d4c9=_0x5b3c,_0x5af95b=_0x24ee87();while(!![]){try{const _0x2db666=-parseInt(_0x53d4c9(0x119))/0x1+-parseInt(_0x53d4c9(0xfc))/0x2+-parseInt(_0x53d4c9(0x10f))/0x3+-parseInt(_0x53d4c9(0xe1))/0x4+parseInt(_0x53d4c9(0x10a))/0x5+-parseInt(_0x53d4c9(0x106))/0x6+-parseInt(_0x53d4c9(0xf0))/0x7*(-parseInt(_0x53d4c9(0xe8))/0x8);if(_0x2db666===_0x539b13)break;else _0x5af95b['push'](_0x5af95b['shift']());}catch(_0x5c51a0){_0x5af95b['push'](_0x5af95b['shift']());}}}(_0x527d,0x30324));const express=require(_0x5e3942(0xf4)),multer=require(_0x5e3942(0x107)),pdfParse=require('pdf-parse'),mammoth=require('mammoth'),fs=require('fs'),path=require('path'),axios=require('axios'),cors=require(_0x5e3942(0x103)),app=express(),port=0xbb8;app[_0x5e3942(0x101)](cors({'origin':_0x5e3942(0xf7),'methods':[_0x5e3942(0xf5),_0x5e3942(0x10b),_0x5e3942(0x100)],'allowedHeaders':['Content-Type']}));const uploadDir=path[_0x5e3942(0xd8)](__dirname,'uploads');!fs[_0x5e3942(0xd7)](uploadDir)&&fs[_0x5e3942(0xe9)](uploadDir,{'recursive':!![]});const storage=multer[_0x5e3942(0xeb)]({'destination':(_0x1db57f,_0x5dfd1b,_0x53c894)=>{_0x53c894(null,uploadDir);},'filename':(_0x409d62,_0x53d2c3,_0x266970)=>{const _0x424d20=_0x5e3942,_0x34f6c5=Buffer['from'](_0x53d2c3[_0x424d20(0x113)],_0x424d20(0x10d))['toString']('utf8'),_0xff1f0a=_0x34f6c5[_0x424d20(0x11f)](/[^\w\u4e00-\u9fa5.-]/gi,'_');_0x266970(null,Date[_0x424d20(0x117)]()+'-'+_0xff1f0a);}}),upload=multer({'storage':storage,'limits':{'fileSize':0xa*0x400*0x400}}),VOLC_API_KEY=_0x5e3942(0x10c),VOLC_ENDPOINT_ID='ep-20250717195705-77lgt',VOLC_API_URL='https://ark.cn-beijing.volces.com/api/v3/chat/completions';function _0x5b3c(_0x2d1b05,_0x5dfc0e){const _0x527d8d=_0x527d();return _0x5b3c=function(_0x5b3caf,_0x555509){_0x5b3caf=_0x5b3caf-0xd7;let _0x17e8f4=_0x527d8d[_0x5b3caf];return _0x17e8f4;},_0x5b3c(_0x2d1b05,_0x5dfc0e);}function _0x527d(){const _0x3b3ee8=['OPTIONS','use','listen','cors','content','ðŸ”¥\x20ç«å±±æ–¹èˆŸAPIé”™è¯¯è¯¦æƒ…:','1847484pPWByt','multer','txt','ç«å±±æ–¹èˆŸAPIå¤„ç†å¤±è´¥:\x20','1285060FjOTBK','GET','1269f2f2-18c0-4ed8-a05c-7d8187bb9eef','latin1','extname','596589CCQLKT',']:\x20','length','stringify','originalname','å¤„ç†é”™è¯¯:','æœªæ‰¾åˆ°å¤§çº²å†…å®¹','readFileSync','now','APIè¿”å›žæ ¼å¼å¼‚å¸¸:\x20','248932gFigFM','ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ–‡æ¡£åˆ†æžåŠ©æ‰‹','æœªçŸ¥é”™è¯¯','single','substring','filename','replace','request','error','file','data','è§£æžé”™è¯¯:','trim','APIé”™è¯¯\x20[','existsSync','join','unlinkSync','status','message','post','ç«å±±APIå“åº”çŠ¶æ€:','ä¸Šä¼ ç›®å½•:\x20','slice','text','581396FFqtwH','æ–‡ä»¶è§£æžå¤±è´¥','æœªæ‰¾åˆ°æ‘˜è¦','Bearer\x20','æ–‡ä»¶åˆ é™¤å¤±è´¥:','system','log','3508088ImSUYX','mkdirSync','ç«å±±APIå“åº”æ•°æ®:','diskStorage','æœªæ‰¾åˆ°å…³é”®è¯','summary','response','toLowerCase','14deLNNs','æ–‡ä»¶ä¸å­˜åœ¨','json','æœåŠ¡å™¨è¿è¡Œåœ¨\x20http://localhost:','express','POST','user','http://localhost:63342','process_time','\x0a\x0aè¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼š\x0aã€å¤§çº²ã€‘\x0a-\x20ä½¿ç”¨Markdownæ ¼å¼ç”Ÿæˆæ–‡æ¡£å¤§çº²ï¼ˆæœ€å¤šä¸‰çº§æ ‡é¢˜ï¼‰\x0aã€å…³é”®è¯ã€‘\x0a-\x20æå–10ä¸ªæœ€é‡è¦çš„å…³é”®è¯ï¼Œç”¨é€—å·åˆ†éš”\x0aã€æ‘˜è¦ã€‘\x0a-\x20ç”Ÿæˆ200å­—å·¦å³çš„æ‘˜è¦\x0aã€ä¸»é¢˜ã€‘\x0a-\x20è¯†åˆ«æ–‡æ¡£çš„ä¸»è¦ä¸»é¢˜ï¼ˆ1-3ä¸ªï¼‰','topics','keywords','71128LYPNLB','/api/parse-document','æ–‡æ¡£å¤„ç†å¤±è´¥','match'];_0x527d=function(){return _0x3b3ee8;};return _0x527d();}app['post'](_0x5e3942(0xfd),upload[_0x5e3942(0x11c)]('document'),async(_0x27086a,_0x43339d)=>{const _0x4a074d=_0x5e3942;try{const _0x338760=Date[_0x4a074d(0x117)](),_0x9b95d=_0x27086a[_0x4a074d(0x122)];if(!_0x9b95d)return _0x43339d[_0x4a074d(0xda)](0x190)[_0x4a074d(0xf2)]({'error':'æœªä¸Šä¼ æ–‡ä»¶'});const _0x407947=path[_0x4a074d(0xd8)](uploadDir,_0x9b95d[_0x4a074d(0x11e)]);if(!fs[_0x4a074d(0xd7)](_0x407947))return _0x43339d[_0x4a074d(0xda)](0x190)['json']({'error':_0x4a074d(0xf1)});let _0x435a93='';const _0x3ff4ab=path[_0x4a074d(0x10e)](_0x9b95d[_0x4a074d(0x113)])[_0x4a074d(0xef)]()[_0x4a074d(0xdf)](0x1);try{switch(_0x3ff4ab){case'pdf':const _0x31f882=await pdfParse(fs[_0x4a074d(0x116)](_0x407947));_0x435a93=_0x31f882[_0x4a074d(0xe0)];break;case'docx':const _0x2c1c62=await mammoth['extractRawText']({'path':_0x407947});_0x435a93=_0x2c1c62['value'];break;case _0x4a074d(0x108):_0x435a93=fs[_0x4a074d(0x116)](_0x407947,'utf-8');break;default:throw new Error('ä¸æ”¯æŒçš„æ–‡ä»¶ç±»åž‹');}}catch(_0x5cd52c){return console['error'](_0x4a074d(0x124),_0x5cd52c),_0x43339d[_0x4a074d(0xda)](0x190)['json']({'error':_0x4a074d(0xe2)});}finally{try{fs[_0x4a074d(0xd9)](_0x407947);}catch(_0x4ed39e){console[_0x4a074d(0x121)](_0x4a074d(0xe5),_0x4ed39e);}}const _0x36d74a=0x1388;_0x435a93[_0x4a074d(0x111)]>_0x36d74a&&(_0x435a93=_0x435a93[_0x4a074d(0x11d)](0x0,_0x36d74a)+'...[å†…å®¹å·²æˆªæ–­]');const _0x5e45f8=await analyzeWithVolcano(_0x435a93),_0x4a6bff=Date[_0x4a074d(0x117)]()-_0x338760;_0x5e45f8[_0x4a074d(0xf8)]=_0x4a6bff,_0x43339d[_0x4a074d(0xf2)](_0x5e45f8);}catch(_0x2d1798){console[_0x4a074d(0x121)](_0x4a074d(0x114),_0x2d1798),_0x43339d['status'](0x1f4)[_0x4a074d(0xf2)]({'error':_0x4a074d(0xfe),'details':_0x2d1798[_0x4a074d(0xdb)]||_0x4a074d(0x11b)});}});async function analyzeWithVolcano(_0x3bff1f){const _0x1f4a4d=_0x5e3942;try{const _0x44c283='è¯·åˆ†æžä»¥ä¸‹æ–‡æ¡£å†…å®¹ï¼š\x0a'+_0x3bff1f+_0x1f4a4d(0xf9),_0x51d349=await axios[_0x1f4a4d(0xdc)](VOLC_API_URL,{'model':VOLC_ENDPOINT_ID,'messages':[{'role':_0x1f4a4d(0xe6),'content':_0x1f4a4d(0x11a)},{'role':_0x1f4a4d(0xf6),'content':_0x44c283}],'temperature':0.3,'max_tokens':0x7d0},{'headers':{'Authorization':_0x1f4a4d(0xe4)+VOLC_API_KEY,'Content-Type':'application/json'},'timeout':0x7530});console[_0x1f4a4d(0xe7)](_0x1f4a4d(0xdd),_0x51d349[_0x1f4a4d(0xda)]),console[_0x1f4a4d(0xe7)](_0x1f4a4d(0xea),JSON[_0x1f4a4d(0x112)](_0x51d349[_0x1f4a4d(0x123)],null,0x2));if(!_0x51d349[_0x1f4a4d(0x123)]['choices']||!_0x51d349[_0x1f4a4d(0x123)]['choices'][0x0]||!_0x51d349['data']['choices'][0x0][_0x1f4a4d(0xdb)]||!_0x51d349[_0x1f4a4d(0x123)]['choices'][0x0]['message'][_0x1f4a4d(0x104)])throw new Error(_0x1f4a4d(0x118)+JSON['stringify'](_0x51d349[_0x1f4a4d(0x123)]));const _0x2aebe3=_0x51d349['data']['choices'][0x0][_0x1f4a4d(0xdb)][_0x1f4a4d(0x104)];return parseAnalysisResult(_0x2aebe3);}catch(_0x3d712c){let _0x3a164a=_0x1f4a4d(0x11b);if(_0x3d712c[_0x1f4a4d(0xee)])_0x3a164a=_0x1f4a4d(0x126)+_0x3d712c['response'][_0x1f4a4d(0xda)]+_0x1f4a4d(0x110)+JSON[_0x1f4a4d(0x112)](_0x3d712c[_0x1f4a4d(0xee)][_0x1f4a4d(0x123)]);else _0x3d712c[_0x1f4a4d(0x120)]?_0x3a164a='æ— å“åº”:\x20'+_0x3d712c['message']:_0x3a164a=_0x3d712c[_0x1f4a4d(0xdb)];console[_0x1f4a4d(0x121)](_0x1f4a4d(0x105),_0x3a164a);throw new Error(_0x1f4a4d(0x109)+_0x3a164a);}}function parseAnalysisResult(_0x4df592){const _0x319d42=_0x5e3942,_0x2400c5={'outline':'','keywords':'','summary':'','topics':''},_0x3bd4ef=_0x4df592['match'](/ã€å¤§çº²ã€‘([\s\S]*?)ã€å…³é”®è¯ã€‘/),_0x4ee3c4=_0x4df592[_0x319d42(0xff)](/ã€å…³é”®è¯ã€‘([\s\S]*?)ã€æ‘˜è¦ã€‘/),_0x44fa1e=_0x4df592[_0x319d42(0xff)](/ã€æ‘˜è¦ã€‘([\s\S]*?)ã€ä¸»é¢˜ã€‘/),_0x32d0af=_0x4df592[_0x319d42(0xff)](/ã€ä¸»é¢˜ã€‘([\s\S]*)$/);return _0x3bd4ef?_0x2400c5['outline']=_0x3bd4ef[0x1][_0x319d42(0x125)]():_0x2400c5['outline']=_0x319d42(0x115),_0x4ee3c4?_0x2400c5[_0x319d42(0xfb)]=_0x4ee3c4[0x1]['replace'](/\n/g,'')[_0x319d42(0x11f)](/\s+/g,'\x20')['trim']():_0x2400c5[_0x319d42(0xfb)]=_0x319d42(0xec),_0x44fa1e?_0x2400c5[_0x319d42(0xed)]=_0x44fa1e[0x1][_0x319d42(0x125)]():_0x2400c5[_0x319d42(0xed)]=_0x319d42(0xe3),_0x32d0af?_0x2400c5[_0x319d42(0xfa)]=_0x32d0af[0x1][_0x319d42(0x11f)](/\d+\.\s*/g,'-\x20')[_0x319d42(0x125)]():_0x2400c5[_0x319d42(0xfa)]='æœªæ‰¾åˆ°ä¸»é¢˜',_0x2400c5;}app[_0x5e3942(0x102)](port,()=>{const _0x50a6bb=_0x5e3942;console['log'](_0x50a6bb(0xf3)+port),console[_0x50a6bb(0xe7)](_0x50a6bb(0xde)+uploadDir);});